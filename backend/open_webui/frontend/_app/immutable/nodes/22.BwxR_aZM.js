import{S as ge,i as pe,s as he,C as j,D as A,E as O,q as p,r as $,F as P,v as De,l as Z,p as G,g as N,d as h,x as St,z as Ut,A as zt,B as Rt,V as ye,W as Ie,a as I,f as g,h as w,n as ae,H as be,I as $e,m as re,K as we,y as J,u as x,k as oe,e as T,c as D,ak as Bt,G as de,t as ne,b as se,j as fe,a0 as gt,U as ve,X as jt,M as Te,w as pt,_ as bt,o as At}from"../chunks/BsAB9Z30.js";import"../chunks/IHki7fMi.js";import{p as Ot}from"../chunks/D2VKnAEk.js";import{t as ke}from"../chunks/DQjSdZ1e.js";import{P as Pt,c as vt,d as Ht}from"../chunks/i3YK7P2g.js";import{g as kt}from"../chunks/BYfvXhfD.js";import{u as Me,a as Wt,g as Ve,e as Ce,m as Yt,s as Le,k as Zt,r as $t,j as je}from"../chunks/Px_ajtSr.js";import{d as Gt,u as Ft,r as Kt,a as qt,g as Ae,s as wt,b as Xt,c as Oe}from"../chunks/C4LfOicd.js";import{e as Ee,u as Qt,o as Jt}from"../chunks/BjVHJN9o.js";import{d as ie,r as Et}from"../chunks/I1CDPYOB.js";import{D as yt,E as It,l as xt,F as Pe}from"../chunks/C06TgqeF.js";import{L as el,a as tl,U as ll,M as Tt,I as rl}from"../chunks/Do3D_Int.js";import{N as nl,P as sl}from"../chunks/X57m8tU6.js";import{C as il}from"../chunks/B3qUBvVu.js";import{G as al}from"../chunks/C-kqD5vK.js";import{P as ol}from"../chunks/BrJK0JaC.js";import{T as _e}from"../chunks/cMkWkffq.js";import{T as fl}from"../chunks/DmxdQp_j.js";import{C as ul,F as cl}from"../chunks/C-kfCiLr.js";import"../chunks/CgqN014N.js";import{E as Dt}from"../chunks/CWY_Z6OT.js";import{C as dl}from"../chunks/6bX91EV5.js";import{E as ml}from"../chunks/BJHkL7lq.js";import{S as _l}from"../chunks/BO0KuA--.js";import{L as hl}from"../chunks/LNJKunkS.js";import{S as Mt}from"../chunks/CbQmQGdd.js";import{M as Vt}from"../chunks/CrcbjeIM.js";import{U as gl}from"../chunks/Ct4-mFWL.js";import{S as pl}from"../chunks/BfJ33jvc.js";import{D as bl}from"../chunks/CXCiFWhq.js";import{X as vl}from"../chunks/CubwYUHd.js";import{i as kl}from"../chunks/CL0EuV-A.js";function $l(s){let e;const l=s[1].default,t=St(l,s,s[2],null);return{c(){t&&t.c()},l(r){t&&t.l(r)},m(r,n){t&&t.m(r,n),e=!0},p(r,n){t&&t.p&&(!e||n&4)&&Ut(t,l,r,r[2],e?Rt(l,r[2],n,null):zt(r[2]),null)},i(r){e||(p(t,r),e=!0)},o(r){$(t,r),e=!1},d(r){t&&t.d(r)}}}function wl(s){var n;let e,l,t,r;return e=new tl({props:{class:" cursor-pointer no-underline! font-normal! ",$$slots:{default:[$l]},$$scope:{ctx:s}}}),t=new ll({props:{id:(n=s[0])==null?void 0:n.id,side:"right",align:"center",sideOffset:8}}),{c(){j(e.$$.fragment),l=Z(),j(t.$$.fragment)},l(i){A(e.$$.fragment,i),l=G(i),A(t.$$.fragment,i)},m(i,a){O(e,i,a),N(i,l,a),O(t,i,a),r=!0},p(i,a){var f;const o={};a&4&&(o.$$scope={dirty:a,ctx:i}),e.$set(o);const u={};a&1&&(u.id=(f=i[0])==null?void 0:f.id),t.$set(u)},i(i){r||(p(e.$$.fragment,i),p(t.$$.fragment,i),r=!0)},o(i){$(e.$$.fragment,i),$(t.$$.fragment,i),r=!1},d(i){i&&h(l),P(e,i),P(t,i)}}}function El(s){let e,l;return e=new el({props:{openDelay:0,closeDelay:0,$$slots:{default:[wl]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,[r]){const n={};r&5&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function yl(s,e,l){let{$$slots:t={},$$scope:r}=e;De("i18n");let{user:n=null}=e;return s.$$set=i=>{"user"in i&&l(0,n=i.user),"$$scope"in i&&l(2,r=i.$$scope)},[n,t,r]}class Il extends ge{constructor(e){super(),pe(this,e,yl,El,he,{user:0})}}function Tl(s){let e,l;return{c(){e=ye("svg"),l=ye("path"),this.h()},l(t){e=Ie(t,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var r=I(e);l=Ie(r,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),I(l).forEach(h),r.forEach(h),this.h()},h(){g(l,"stroke-linecap","round"),g(l,"stroke-linejoin","round"),g(l,"d","M15.182 15.182a4.5 4.5 0 0 1-6.364 0M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0ZM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Z"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"fill","none"),g(e,"viewBox","0 0 24 24"),g(e,"stroke-width",s[1]),g(e,"stroke","currentColor"),g(e,"class",s[0])},m(t,r){N(t,e,r),w(e,l)},p(t,[r]){r&2&&g(e,"stroke-width",t[1]),r&1&&g(e,"class",t[0])},i:ae,o:ae,d(t){t&&h(e)}}}function Dl(s,e,l){let{className:t="size-4"}=e,{strokeWidth:r="1.5"}=e;return s.$$set=n=>{"className"in n&&l(0,t=n.className),"strokeWidth"in n&&l(1,r=n.strokeWidth)},[t,r]}class Ct extends ge{constructor(e){super(),pe(this,e,Dl,Tl,he,{className:0,strokeWidth:1})}}function Ml(s){let e,l,t;return{c(){e=ye("svg"),l=ye("path"),t=ye("path"),this.h()},l(r){e=Ie(r,"svg",{class:!0,"aria-hidden":!0,xmlns:!0,"stroke-width":!0,fill:!0,stroke:!0,viewBox:!0});var n=I(e);l=Ie(n,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),I(l).forEach(h),t=Ie(n,"path",{d:!0,"stroke-linecap":!0,"stroke-linejoin":!0}),I(t).forEach(h),n.forEach(h),this.h()},h(){g(l,"d","M10.25 4.75L6.75 8.25L10.25 11.75"),g(l,"stroke-linecap","round"),g(l,"stroke-linejoin","round"),g(t,"d","M6.75 8.25L12.75 8.25C14.9591 8.25 16.75 10.0409 16.75 12.25V19.25"),g(t,"stroke-linecap","round"),g(t,"stroke-linejoin","round"),g(e,"class",s[0]),g(e,"aria-hidden","true"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"stroke-width",s[1]),g(e,"fill","none"),g(e,"stroke","currentColor"),g(e,"viewBox","0 0 24 24")},m(r,n){N(r,e,n),w(e,l),w(e,t)},p(r,[n]){n&1&&g(e,"class",r[0]),n&2&&g(e,"stroke-width",r[1])},i:ae,o:ae,d(r){r&&h(e)}}}function Vl(s,e,l){let{className:t="w-4 h-4"}=e,{strokeWidth:r="1.5"}=e;return s.$$set=n=>{"className"in n&&l(0,t=n.className),"strokeWidth"in n&&l(1,r=n.strokeWidth)},[t,r]}class Cl extends ge{constructor(e){super(),pe(this,e,Vl,Ml,he,{className:0,strokeWidth:1})}}function He(s,e,l){const t=s.slice();return t[35]=e[l],t}function We(s,e,l){const t=s.slice();return t[38]=e[l],t}function Ye(s){var W,q,Q,K;let e,l,t,r,n,i,a,o,u,f,d,m,b,v,_,c,k,L,M,V=!s[11]&&!s[4]&&Ze(s),B=((q=(W=s[0])==null?void 0:W.reply_to_message)==null?void 0:q.user)&&Ke(s);const X=[Ol,Al],y=[];function U(z,Y){return z[1]?0:1}i=U(s),a=y[i]=X[i](s);let R=s[1]&&Xe(s),H=(((K=(Q=s[0])==null?void 0:Q.data)==null?void 0:K.files)??[]).length>0&&Je(s);const F=[Jl,Ql],E=[];function ee(z,Y){return z[11]?0:1}return m=ee(s),b=E[m]=F[m](s),{c(){e=T("div"),V&&V.c(),l=Z(),B&&B.c(),t=Z(),r=T("div"),n=T("div"),a.c(),o=Z(),u=T("div"),R&&R.c(),f=Z(),H&&H.c(),d=Z(),b.c(),this.h()},l(z){e=D(z,"DIV",{id:!0,class:!0});var Y=I(e);V&&V.l(Y),l=G(Y),B&&B.l(Y),t=G(Y),r=D(Y,"DIV",{class:!0,id:!0,dir:!0});var C=I(r);n=D(C,"DIV",{class:!0});var le=I(n);a.l(le),le.forEach(h),o=G(C),u=D(C,"DIV",{class:!0});var S=I(u);R&&R.l(S),f=G(S),H&&H.l(S),d=G(S),b.l(S),S.forEach(h),C.forEach(h),Y.forEach(h),this.h()},h(){var z,Y,C,le,S,ce;g(n,"class",Bt("shrink-0 mr-3 w-9")+" svelte-870i4"),g(u,"class","flex-auto w-0 pl-1"),g(r,"class",v="flex w-full message-"+s[0].id+" svelte-870i4"),g(r,"id",_="message-"+s[0].id),g(r,"dir",c=s[16].chatDirection),g(e,"id",k="message-"+s[0].id),g(e,"class",L="flex flex-col justify-between px-5 "+(s[1]?"pt-1.5 pb-0.5":"")+" w-full max-w-full mx-auto group hover:bg-gray-300/5 dark:hover:bg-gray-700/5 transition relative "+(s[3]?"border-l-4 border-blue-500 bg-blue-100/10 dark:bg-blue-100/5 pl-4":"")+" "+((((C=(Y=(z=s[0])==null?void 0:z.reply_to_message)==null?void 0:Y.meta)==null?void 0:C.model_id)??((S=(le=s[0])==null?void 0:le.reply_to_message)==null?void 0:S.user_id))===((ce=s[15])==null?void 0:ce.id)?"border-l-4 border-orange-500 bg-orange-100/10 dark:bg-orange-100/5 pl-4":""))},m(z,Y){N(z,e,Y),V&&V.m(e,null),w(e,l),B&&B.m(e,null),w(e,t),w(e,r),w(r,n),y[i].m(n,null),w(r,o),w(r,u),R&&R.m(u,null),w(u,f),H&&H.m(u,null),w(u,d),E[m].m(u,null),M=!0},p(z,Y){var S,ce,ue,te,me,Se,Ue,ze,Re,Be;!z[11]&&!z[4]?V?(V.p(z,Y),Y[0]&2064&&p(V,1)):(V=Ze(z),V.c(),p(V,1),V.m(e,l)):V&&(J(),$(V,1,1,()=>{V=null}),x()),(ce=(S=z[0])==null?void 0:S.reply_to_message)!=null&&ce.user?B?(B.p(z,Y),Y[0]&1&&p(B,1)):(B=Ke(z),B.c(),p(B,1),B.m(e,t)):B&&(J(),$(B,1,1,()=>{B=null}),x());let C=i;i=U(z),i===C?y[i].p(z,Y):(J(),$(y[C],1,1,()=>{y[C]=null}),x(),a=y[i],a?a.p(z,Y):(a=y[i]=X[i](z),a.c()),p(a,1),a.m(n,null)),z[1]?R?(R.p(z,Y),Y[0]&2&&p(R,1)):(R=Xe(z),R.c(),p(R,1),R.m(u,f)):R&&(J(),$(R,1,1,()=>{R=null}),x()),(((te=(ue=z[0])==null?void 0:ue.data)==null?void 0:te.files)??[]).length>0?H?(H.p(z,Y),Y[0]&1&&p(H,1)):(H=Je(z),H.c(),p(H,1),H.m(u,d)):H&&(J(),$(H,1,1,()=>{H=null}),x());let le=m;m=ee(z),m===le?E[m].p(z,Y):(J(),$(E[le],1,1,()=>{E[le]=null}),x(),b=E[m],b?b.p(z,Y):(b=E[m]=F[m](z),b.c()),p(b,1),b.m(u,null)),(!M||Y[0]&1&&v!==(v="flex w-full message-"+z[0].id+" svelte-870i4"))&&g(r,"class",v),(!M||Y[0]&1&&_!==(_="message-"+z[0].id))&&g(r,"id",_),(!M||Y[0]&65536&&c!==(c=z[16].chatDirection))&&g(r,"dir",c),(!M||Y[0]&1&&k!==(k="message-"+z[0].id))&&g(e,"id",k),(!M||Y[0]&32779&&L!==(L="flex flex-col justify-between px-5 "+(z[1]?"pt-1.5 pb-0.5":"")+" w-full max-w-full mx-auto group hover:bg-gray-300/5 dark:hover:bg-gray-700/5 transition relative "+(z[3]?"border-l-4 border-blue-500 bg-blue-100/10 dark:bg-blue-100/5 pl-4":"")+" "+((((Ue=(Se=(me=z[0])==null?void 0:me.reply_to_message)==null?void 0:Se.meta)==null?void 0:Ue.model_id)??((Re=(ze=z[0])==null?void 0:ze.reply_to_message)==null?void 0:Re.user_id))===((Be=z[15])==null?void 0:Be.id)?"border-l-4 border-orange-500 bg-orange-100/10 dark:bg-orange-100/5 pl-4":"")))&&g(e,"class",L)},i(z){M||(p(V),p(B),p(a),p(R),p(H),p(b),M=!0)},o(z){$(V),$(B),$(a),$(R),$(H),$(b),M=!1},d(z){z&&h(e),V&&V.d(),B&&B.d(),y[i].d(),R&&R.d(),H&&H.d(),E[m].d()}}}function Ze(s){var m,b;let e,l,t,r,n,i,a,o,u;t=new Dt({props:{onClose:s[21],onSubmit:s[22],$$slots:{default:[Ll]},$$scope:{ctx:s}}}),n=new _e({props:{content:s[14].t("Reply"),$$slots:{default:[Sl]},$$scope:{ctx:s}}});let f=!s[2]&&Ge(s),d=(s[0].user_id===((m=s[15])==null?void 0:m.id)||((b=s[15])==null?void 0:b.role)==="admin")&&Fe(s);return{c(){e=T("div"),l=T("div"),j(t.$$.fragment),r=Z(),j(n.$$.fragment),i=Z(),f&&f.c(),a=Z(),d&&d.c(),this.h()},l(v){e=D(v,"DIV",{class:!0});var _=I(e);l=D(_,"DIV",{class:!0});var c=I(l);A(t.$$.fragment,c),r=G(c),A(n.$$.fragment,c),i=G(c),f&&f.l(c),a=G(c),d&&d.l(c),c.forEach(h),_.forEach(h),this.h()},h(){g(l,"class","flex gap-1 rounded-lg bg-white dark:bg-gray-850 shadow-md p-0.5 border border-gray-100 dark:border-gray-850"),g(e,"class",o="absolute "+(s[10]?"":"invisible group-hover:visible")+" right-1 -top-2 z-10")},m(v,_){N(v,e,_),w(e,l),O(t,l,null),w(l,r),O(n,l,null),w(l,i),f&&f.m(l,null),w(l,a),d&&d.m(l,null),u=!0},p(v,_){var L,M;const c={};_[0]&1024&&(c.onClose=v[21]),_[0]&1536&&(c.onSubmit=v[22]),_[0]&17408|_[1]&1024&&(c.$$scope={dirty:_,ctx:v}),t.$set(c);const k={};_[0]&16384&&(k.content=v[14].t("Reply")),_[0]&129|_[1]&1024&&(k.$$scope={dirty:_,ctx:v}),n.$set(k),v[2]?f&&(J(),$(f,1,1,()=>{f=null}),x()):f?(f.p(v,_),_[0]&4&&p(f,1)):(f=Ge(v),f.c(),p(f,1),f.m(l,a)),v[0].user_id===((L=v[15])==null?void 0:L.id)||((M=v[15])==null?void 0:M.role)==="admin"?d?(d.p(v,_),_[0]&32769&&p(d,1)):(d=Fe(v),d.c(),p(d,1),d.m(l,null)):d&&(J(),$(d,1,1,()=>{d=null}),x()),(!u||_[0]&1024&&o!==(o="absolute "+(v[10]?"":"invisible group-hover:visible")+" right-1 -top-2 z-10"))&&g(e,"class",o)},i(v){u||(p(t.$$.fragment,v),p(n.$$.fragment,v),p(f),p(d),u=!0)},o(v){$(t.$$.fragment,v),$(n.$$.fragment,v),$(f),$(d),u=!1},d(v){v&&h(e),P(t),P(n),f&&f.d(),d&&d.d()}}}function Nl(s){let e,l,t,r,n;return l=new Ct({}),{c(){e=T("button"),j(l.$$.fragment),this.h()},l(i){e=D(i,"BUTTON",{class:!0});var a=I(e);A(l.$$.fragment,a),a.forEach(h),this.h()},h(){g(e,"class","hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1")},m(i,a){N(i,e,a),O(l,e,null),t=!0,r||(n=de(e,"click",s[20]),r=!0)},p:ae,i(i){t||(p(l.$$.fragment,i),t=!0)},o(i){$(l.$$.fragment,i),t=!1},d(i){i&&h(e),P(l),r=!1,n()}}}function Ll(s){let e,l;return e=new _e({props:{content:s[14].t("Add Reaction"),$$slots:{default:[Nl]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,r){const n={};r[0]&16384&&(n.content=t[14].t("Add Reaction")),r[0]&1024|r[1]&1024&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Sl(s){let e,l,t,r,n;return l=new Cl({props:{className:"size-5"}}),{c(){e=T("button"),j(l.$$.fragment),this.h()},l(i){e=D(i,"BUTTON",{class:!0});var a=I(e);A(l.$$.fragment,a),a.forEach(h),this.h()},h(){g(e,"class","hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-0.5")},m(i,a){N(i,e,a),O(l,e,null),t=!0,r||(n=de(e,"click",s[23]),r=!0)},p:ae,i(i){t||(p(l.$$.fragment,i),t=!0)},o(i){$(l.$$.fragment,i),t=!1},d(i){i&&h(e),P(l),r=!1,n()}}}function Ge(s){let e,l;return e=new _e({props:{content:s[14].t("Reply in Thread"),$$slots:{default:[Ul]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,r){const n={};r[0]&16384&&(n.content=t[14].t("Reply in Thread")),r[0]&257|r[1]&1024&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Ul(s){let e,l,t,r,n;return l=new ul({}),{c(){e=T("button"),j(l.$$.fragment),this.h()},l(i){e=D(i,"BUTTON",{class:!0});var a=I(e);A(l.$$.fragment,a),a.forEach(h),this.h()},h(){g(e,"class","hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1")},m(i,a){N(i,e,a),O(l,e,null),t=!0,r||(n=de(e,"click",s[24]),r=!0)},p:ae,i(i){t||(p(l.$$.fragment,i),t=!0)},o(i){$(l.$$.fragment,i),t=!1},d(i){i&&h(e),P(l),r=!1,n()}}}function Fe(s){let e,l,t,r;return e=new _e({props:{content:s[14].t("Edit"),$$slots:{default:[zl]},$$scope:{ctx:s}}}),t=new _e({props:{content:s[14].t("Delete"),$$slots:{default:[Rl]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment),l=Z(),j(t.$$.fragment)},l(n){A(e.$$.fragment,n),l=G(n),A(t.$$.fragment,n)},m(n,i){O(e,n,i),N(n,l,i),O(t,n,i),r=!0},p(n,i){const a={};i[0]&16384&&(a.content=n[14].t("Edit")),i[0]&6145|i[1]&1024&&(a.$$scope={dirty:i,ctx:n}),e.$set(a);const o={};i[0]&16384&&(o.content=n[14].t("Delete")),i[0]&8192|i[1]&1024&&(o.$$scope={dirty:i,ctx:n}),t.$set(o)},i(n){r||(p(e.$$.fragment,n),p(t.$$.fragment,n),r=!0)},o(n){$(e.$$.fragment,n),$(t.$$.fragment,n),r=!1},d(n){n&&h(l),P(e,n),P(t,n)}}}function zl(s){let e,l,t,r,n;return l=new ol({}),{c(){e=T("button"),j(l.$$.fragment),this.h()},l(i){e=D(i,"BUTTON",{class:!0});var a=I(e);A(l.$$.fragment,a),a.forEach(h),this.h()},h(){g(e,"class","hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1")},m(i,a){N(i,e,a),O(l,e,null),t=!0,r||(n=de(e,"click",s[25]),r=!0)},p:ae,i(i){t||(p(l.$$.fragment,i),t=!0)},o(i){$(l.$$.fragment,i),t=!1},d(i){i&&h(e),P(l),r=!1,n()}}}function Rl(s){let e,l,t,r,n;return l=new al({}),{c(){e=T("button"),j(l.$$.fragment),this.h()},l(i){e=D(i,"BUTTON",{class:!0});var a=I(e);A(l.$$.fragment,a),a.forEach(h),this.h()},h(){g(e,"class","hover:bg-gray-100 dark:hover:bg-gray-800 transition rounded-lg p-1")},m(i,a){N(i,e,a),O(l,e,null),t=!0,r||(n=de(e,"click",s[26]),r=!0)},p:ae,i(i){t||(p(l.$$.fragment,i),t=!0)},o(i){$(l.$$.fragment,i),t=!1},d(i){i&&h(e),P(l),r=!1,n()}}}function Ke(s){var L,M,V,B,X,y;let e,l,t,r,n,i,a=(((M=(L=s[0])==null?void 0:L.reply_to_message.meta)==null?void 0:M.model_name)??((B=(V=s[0])==null?void 0:V.reply_to_message.user)==null?void 0:B.name)??s[14].t("Unknown User"))+"",o,u,f,d,m,b,v;function _(U,R){var H,F,E;return(E=(F=(H=U[0])==null?void 0:H.reply_to_message)==null?void 0:F.meta)!=null&&E.model_id?jl:Bl}let c=_(s),k=c(s);return d=new Tt({props:{id:`${s[0].id}-reply-to`,content:(y=(X=s[0])==null?void 0:X.reply_to_message)==null?void 0:y.content}}),{c(){e=T("div"),l=T("div"),t=Z(),r=T("button"),k.c(),n=Z(),i=T("div"),o=ne(a),u=Z(),f=T("div"),j(d.$$.fragment),this.h()},l(U){e=D(U,"DIV",{class:!0});var R=I(e);l=D(R,"DIV",{class:!0}),I(l).forEach(h),t=G(R),r=D(R,"BUTTON",{class:!0});var H=I(r);k.l(H),n=G(H),i=D(H,"DIV",{class:!0});var F=I(i);o=se(F,a),F.forEach(h),u=G(H),f=D(H,"DIV",{class:!0});var E=I(f);A(d.$$.fragment,E),E.forEach(h),H.forEach(h),R.forEach(h),this.h()},h(){g(l,"class","absolute h-3 w-7 left-[18px] top-2 rounded-tl-lg border-t-2 border-l-2 border-gray-300 dark:border-gray-500 z-0"),g(i,"class","shrink-0"),g(f,"class","italic text-sm text-gray-500 dark:text-gray-400 line-clamp-1 w-full flex-1"),g(r,"class","ml-12 flex items-center space-x-2 relative z-0"),g(e,"class","relative text-xs mb-1")},m(U,R){N(U,e,R),w(e,l),w(e,t),w(e,r),k.m(r,null),w(r,n),w(r,i),w(i,o),w(r,u),w(r,f),O(d,f,null),m=!0,b||(v=de(r,"click",s[27]),b=!0)},p(U,R){var F,E,ee,W,q,Q;c===(c=_(U))&&k?k.p(U,R):(k.d(1),k=c(U),k&&(k.c(),k.m(r,n))),(!m||R[0]&16385)&&a!==(a=(((E=(F=U[0])==null?void 0:F.reply_to_message.meta)==null?void 0:E.model_name)??((W=(ee=U[0])==null?void 0:ee.reply_to_message.user)==null?void 0:W.name)??U[14].t("Unknown User"))+"")&&fe(o,a);const H={};R[0]&1&&(H.id=`${U[0].id}-reply-to`),R[0]&1&&(H.content=(Q=(q=U[0])==null?void 0:q.reply_to_message)==null?void 0:Q.content),d.$set(H)},i(U){m||(p(d.$$.fragment,U),m=!0)},o(U){$(d.$$.fragment,U),m=!1},d(U){U&&h(e),k.d(),P(d),b=!1,v()}}}function Bl(s){let e,l,t;return{c(){e=T("img"),this.h()},l(r){e=D(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){var r,n;ve(e.src,l=((r=s[0].reply_to_message.user)==null?void 0:r.profile_image_url)??`${Ve}/static/favicon.png`)||g(e,"src",l),g(e,"alt",t=((n=s[0].reply_to_message.user)==null?void 0:n.name)??s[14].t("Unknown User")),g(e,"class","size-4 ml-0.5 rounded-full object-cover")},m(r,n){N(r,e,n)},p(r,n){var i,a;n[0]&1&&!ve(e.src,l=((i=r[0].reply_to_message.user)==null?void 0:i.profile_image_url)??`${Ve}/static/favicon.png`)&&g(e,"src",l),n[0]&16385&&t!==(t=((a=r[0].reply_to_message.user)==null?void 0:a.name)??r[14].t("Unknown User"))&&g(e,"alt",t)},d(r){r&&h(e)}}}function jl(s){let e,l,t;return{c(){e=T("img"),this.h()},l(r){e=D(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ve(e.src,l=`${Ce}/models/model/profile/image?id=${s[0].reply_to_message.meta.model_id}`)||g(e,"src",l),g(e,"alt",t=s[0].reply_to_message.meta.model_name??s[0].reply_to_message.meta.model_id),g(e,"class","size-4 ml-0.5 rounded-full object-cover")},m(r,n){N(r,e,n)},p(r,n){n[0]&1&&!ve(e.src,l=`${Ce}/models/model/profile/image?id=${r[0].reply_to_message.meta.model_id}`)&&g(e,"src",l),n[0]&1&&t!==(t=r[0].reply_to_message.meta.model_name??r[0].reply_to_message.meta.model_id)&&g(e,"alt",t)},d(r){r&&h(e)}}}function Al(s){let e,l,t=s[0].created_at&&qe(s);return{c(){t&&t.c(),e=re()},l(r){t&&t.l(r),e=re()},m(r,n){t&&t.m(r,n),N(r,e,n),l=!0},p(r,n){r[0].created_at?t?(t.p(r,n),n[0]&1&&p(t,1)):(t=qe(r),t.c(),p(t,1),t.m(e.parentNode,e)):t&&(J(),$(t,1,1,()=>{t=null}),x())},i(r){l||(p(t),l=!0)},o(r){$(t),l=!1},d(r){r&&h(e),t&&t.d(r)}}}function Ol(s){let e,l,t,r;const n=[Wl,Hl],i=[];function a(o,u){var f,d;return(d=(f=o[0])==null?void 0:f.meta)!=null&&d.model_id?0:1}return e=a(s),l=i[e]=n[e](s),{c(){l.c(),t=re()},l(o){l.l(o),t=re()},m(o,u){i[e].m(o,u),N(o,t,u),r=!0},p(o,u){let f=e;e=a(o),e===f?i[e].p(o,u):(J(),$(i[f],1,1,()=>{i[f]=null}),x(),l=i[e],l?l.p(o,u):(l=i[e]=n[e](o),l.c()),p(l,1),l.m(t.parentNode,t))},i(o){r||(p(l),r=!0)},o(o){$(l),r=!1},d(o){o&&h(t),i[e].d(o)}}}function qe(s){let e,l,t;return l=new _e({props:{content:ie(s[0].created_at/1e6).format("LLLL"),$$slots:{default:[Pl]},$$scope:{ctx:s}}}),{c(){e=T("div"),j(l.$$.fragment),this.h()},l(r){e=D(r,"DIV",{class:!0});var n=I(e);A(l.$$.fragment,n),n.forEach(h),this.h()},h(){g(e,"class","mt-1.5 flex shrink-0 items-center text-xs self-center invisible group-hover:visible text-gray-500 font-medium first-letter:capitalize")},m(r,n){N(r,e,n),O(l,e,null),t=!0},p(r,n){const i={};n[0]&1&&(i.content=ie(r[0].created_at/1e6).format("LLLL")),n[0]&1|n[1]&1024&&(i.$$scope={dirty:n,ctx:r}),l.$set(i)},i(r){t||(p(l.$$.fragment,r),t=!0)},o(r){$(l.$$.fragment,r),t=!1},d(r){r&&h(e),P(l)}}}function Pl(s){let e=ie(s[0].created_at/1e6).format("HH:mm")+"",l;return{c(){l=ne(e)},l(t){l=se(t,e)},m(t,r){N(t,l,r)},p(t,r){r[0]&1&&e!==(e=ie(t[0].created_at/1e6).format("HH:mm")+"")&&fe(l,e)},d(t){t&&h(l)}}}function Hl(s){let e,l;return e=new Il({props:{user:s[0].user,$$slots:{default:[Yl]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,r){const n={};r[0]&1&&(n.user=t[0].user),r[0]&1|r[1]&1024&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Wl(s){let e,l,t;return{c(){e=T("img"),this.h()},l(r){e=D(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ve(e.src,l=`${Ce}/models/model/profile/image?id=${s[0].meta.model_id}`)||g(e,"src",l),g(e,"alt",t=s[0].meta.model_name??s[0].meta.model_id),g(e,"class","size-8 translate-y-1 ml-0.5 object-cover rounded-full")},m(r,n){N(r,e,n)},p(r,n){n[0]&1&&!ve(e.src,l=`${Ce}/models/model/profile/image?id=${r[0].meta.model_id}`)&&g(e,"src",l),n[0]&1&&t!==(t=r[0].meta.model_name??r[0].meta.model_id)&&g(e,"alt",t)},i:ae,o:ae,d(r){r&&h(e)}}}function Yl(s){var t;let e,l;return e=new sl({props:{src:((t=s[0].user)==null?void 0:t.profile_image_url)??`${Ve}/static/favicon.png`,className:"size-8 ml-0.5"}}),{c(){j(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,n){O(e,r,n),l=!0},p(r,n){var a;const i={};n[0]&1&&(i.src=((a=r[0].user)==null?void 0:a.profile_image_url)??`${Ve}/static/favicon.png`),e.$set(i)},i(r){l||(p(e.$$.fragment,r),l=!0)},o(r){$(e.$$.fragment,r),l=!1},d(r){P(e,r)}}}function Xe(s){let e,l;return e=new nl({props:{$$slots:{default:[Kl]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,r){const n={};r[0]&16385|r[1]&1024&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Zl(s){var t,r;let e=((r=(t=s[0])==null?void 0:t.user)==null?void 0:r.name)+"",l;return{c(){l=ne(e)},l(n){l=se(n,e)},m(n,i){N(n,l,i)},p(n,i){var a,o;i[0]&1&&e!==(e=((o=(a=n[0])==null?void 0:a.user)==null?void 0:o.name)+"")&&fe(l,e)},d(n){n&&h(l)}}}function Gl(s){var t,r,n,i;let e=(((r=(t=s[0])==null?void 0:t.meta)==null?void 0:r.model_name)??((i=(n=s[0])==null?void 0:n.meta)==null?void 0:i.model_id))+"",l;return{c(){l=ne(e)},l(a){l=se(a,e)},m(a,o){N(a,l,o)},p(a,o){var u,f,d,m;o[0]&1&&e!==(e=(((f=(u=a[0])==null?void 0:u.meta)==null?void 0:f.model_name)??((m=(d=a[0])==null?void 0:d.meta)==null?void 0:m.model_id))+"")&&fe(l,e)},d(a){a&&h(l)}}}function Qe(s){let e,l,t;return l=new _e({props:{content:ie(s[0].created_at/1e6).format("LLLL"),$$slots:{default:[Fl]},$$scope:{ctx:s}}}),{c(){e=T("div"),j(l.$$.fragment),this.h()},l(r){e=D(r,"DIV",{class:!0});var n=I(e);A(l.$$.fragment,n),n.forEach(h),this.h()},h(){g(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(r,n){N(r,e,n),O(l,e,null),t=!0},p(r,n){const i={};n[0]&1&&(i.content=ie(r[0].created_at/1e6).format("LLLL")),n[0]&16385|n[1]&1024&&(i.$$scope={dirty:n,ctx:r}),l.$set(i)},i(r){t||(p(l.$$.fragment,r),t=!0)},o(r){$(l.$$.fragment,r),t=!1},d(r){r&&h(e),P(l)}}}function Fl(s){let e,l=s[14].t(Pe(s[0].created_at/1e6),{LOCALIZED_TIME:ie(s[0].created_at/1e6).format("LT"),LOCALIZED_DATE:ie(s[0].created_at/1e6).format("L")})+"",t;return{c(){e=T("span"),t=ne(l),this.h()},l(r){e=D(r,"SPAN",{class:!0});var n=I(e);t=se(n,l),n.forEach(h),this.h()},h(){g(e,"class","line-clamp-1")},m(r,n){N(r,e,n),w(e,t)},p(r,n){n[0]&16385&&l!==(l=r[14].t(Pe(r[0].created_at/1e6),{LOCALIZED_TIME:ie(r[0].created_at/1e6).format("LT"),LOCALIZED_DATE:ie(r[0].created_at/1e6).format("L")})+"")&&fe(t,l)},d(r){r&&h(e)}}}function Kl(s){let e,l,t,r;function n(u,f){var d,m;return(m=(d=u[0])==null?void 0:d.meta)!=null&&m.model_id?Gl:Zl}let i=n(s),a=i(s),o=s[0].created_at&&Qe(s);return{c(){e=T("div"),a.c(),l=Z(),o&&o.c(),t=re(),this.h()},l(u){e=D(u,"DIV",{class:!0});var f=I(e);a.l(f),f.forEach(h),l=G(u),o&&o.l(u),t=re(),this.h()},h(){g(e,"class","self-end text-base shrink-0 font-medium truncate")},m(u,f){N(u,e,f),a.m(e,null),N(u,l,f),o&&o.m(u,f),N(u,t,f),r=!0},p(u,f){i===(i=n(u))&&a?a.p(u,f):(a.d(1),a=i(u),a&&(a.c(),a.m(e,null))),u[0].created_at?o?(o.p(u,f),f[0]&1&&p(o,1)):(o=Qe(u),o.c(),p(o,1),o.m(t.parentNode,t)):o&&(J(),$(o,1,1,()=>{o=null}),x())},i(u){r||(p(o),r=!0)},o(u){$(o),r=!1},d(u){u&&(h(e),h(l),h(t)),a.d(),o&&o.d(u)}}}function Je(s){var i,a;let e,l,t=Ee((a=(i=s[0])==null?void 0:i.data)==null?void 0:a.files),r=[];for(let o=0;o<t.length;o+=1)r[o]=xe(We(s,t,o));const n=o=>$(r[o],1,1,()=>{r[o]=null});return{c(){e=T("div");for(let o=0;o<r.length;o+=1)r[o].c();this.h()},l(o){e=D(o,"DIV",{class:!0});var u=I(e);for(let f=0;f<r.length;f+=1)r[f].l(u);u.forEach(h),this.h()},h(){g(e,"class","my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap")},m(o,u){N(o,e,u);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);l=!0},p(o,u){var f,d;if(u[0]&1){t=Ee((d=(f=o[0])==null?void 0:f.data)==null?void 0:d.files);let m;for(m=0;m<t.length;m+=1){const b=We(o,t,m);r[m]?(r[m].p(b,u),p(r[m],1)):(r[m]=xe(b),r[m].c(),p(r[m],1),r[m].m(e,null))}for(J(),m=t.length;m<r.length;m+=1)n(m);x()}},i(o){if(!l){for(let u=0;u<t.length;u+=1)p(r[u]);l=!0}},o(o){r=r.filter(Boolean);for(let u=0;u<r.length;u+=1)$(r[u]);l=!1},d(o){o&&h(e),gt(r,o)}}}function ql(s){var t;let e,l;return e=new cl({props:{item:s[38],url:s[38].url,name:s[38].name,type:s[38].type,size:(t=s[38])==null?void 0:t.size,small:!0}}),{c(){j(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,n){O(e,r,n),l=!0},p(r,n){var a;const i={};n[0]&1&&(i.item=r[38]),n[0]&1&&(i.url=r[38].url),n[0]&1&&(i.name=r[38].name),n[0]&1&&(i.type=r[38].type),n[0]&1&&(i.size=(a=r[38])==null?void 0:a.size),e.$set(i)},i(r){l||(p(e.$$.fragment,r),l=!0)},o(r){$(e.$$.fragment,r),l=!1},d(r){P(e,r)}}}function Xl(s){let e,l;return e=new rl({props:{src:s[38].url,alt:s[38].name,imageClassName:" max-h-96 rounded-lg"}}),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,r){const n={};r[0]&1&&(n.src=t[38].url),r[0]&1&&(n.alt=t[38].name),e.$set(n)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function xe(s){let e,l,t,r,n;const i=[Xl,ql],a=[];function o(u,f){return u[38].type==="image"?0:1}return l=o(s),t=a[l]=i[l](s),{c(){e=T("div"),t.c(),r=Z()},l(u){e=D(u,"DIV",{});var f=I(e);t.l(f),r=G(f),f.forEach(h)},m(u,f){N(u,e,f),a[l].m(e,null),w(e,r),n=!0},p(u,f){let d=l;l=o(u),l===d?a[l].p(u,f):(J(),$(a[d],1,1,()=>{a[d]=null}),x(),t=a[l],t?t.p(u,f):(t=a[l]=i[l](u),t.c()),p(t,1),t.m(e,r))},i(u){n||(p(t),n=!0)},o(u){$(t),n=!1},d(u){u&&h(e),a[l].d()}}}function Ql(s){var v;let e,l,t,r,n,i,a,o;const u=[er,xl],f=[];function d(_,c){var k,L,M;return c[0]&1&&(l=null),l==null&&(l=!!((((k=_[0])==null?void 0:k.content)??"").trim()===""&&((M=(L=_[0])==null?void 0:L.meta)!=null&&M.model_id))),l?0:1}t=d(s,[-1,-1]),r=f[t]=u[t](s);let m=(((v=s[0])==null?void 0:v.reactions)??[]).length>0&&tt(s),b=!s[2]&&s[0].reply_count>0&&nt(s);return{c(){e=T("div"),r.c(),n=Z(),m&&m.c(),i=Z(),b&&b.c(),a=re(),this.h()},l(_){e=D(_,"DIV",{class:!0});var c=I(e);r.l(c),c.forEach(h),n=G(_),m&&m.l(_),i=G(_),b&&b.l(_),a=re(),this.h()},h(){g(e,"class","min-w-full markdown-prose")},m(_,c){N(_,e,c),f[t].m(e,null),N(_,n,c),m&&m.m(_,c),N(_,i,c),b&&b.m(_,c),N(_,a,c),o=!0},p(_,c){var L;let k=t;t=d(_,c),t===k?f[t].p(_,c):(J(),$(f[k],1,1,()=>{f[k]=null}),x(),r=f[t],r?r.p(_,c):(r=f[t]=u[t](_),r.c()),p(r,1),r.m(e,null)),(((L=_[0])==null?void 0:L.reactions)??[]).length>0?m?(m.p(_,c),c[0]&1&&p(m,1)):(m=tt(_),m.c(),p(m,1),m.m(i.parentNode,i)):m&&(J(),$(m,1,1,()=>{m=null}),x()),!_[2]&&_[0].reply_count>0?b?(b.p(_,c),c[0]&5&&p(b,1)):(b=nt(_),b.c(),p(b,1),b.m(a.parentNode,a)):b&&(J(),$(b,1,1,()=>{b=null}),x())},i(_){o||(p(r),p(m),p(b),o=!0)},o(_){$(r),$(m),$(b),o=!1},d(_){_&&(h(e),h(n),h(i),h(a)),f[t].d(),m&&m.d(_),b&&b.d(_)}}}function Jl(s){let e,l,t,r,n,i,a,o=s[14].t("Cancel")+"",u,f,d,m=s[14].t("Save")+"",b,v,_,c;function k(M){s[29](M)}let L={className:" bg-transparent outline-hidden w-full resize-none",onKeydown:s[28]};return s[12]!==void 0&&(L.value=s[12]),l=new fl({props:L}),be.push(()=>$e(l,"value",k)),{c(){e=T("div"),j(l.$$.fragment),r=Z(),n=T("div"),i=T("div"),a=T("button"),u=ne(o),f=Z(),d=T("button"),b=ne(m),this.h()},l(M){e=D(M,"DIV",{class:!0});var V=I(e);A(l.$$.fragment,V),r=G(V),n=D(V,"DIV",{class:!0});var B=I(n);i=D(B,"DIV",{class:!0});var X=I(i);a=D(X,"BUTTON",{id:!0,class:!0});var y=I(a);u=se(y,o),y.forEach(h),f=G(X),d=D(X,"BUTTON",{id:!0,class:!0});var U=I(d);b=se(U,m),U.forEach(h),X.forEach(h),B.forEach(h),V.forEach(h),this.h()},h(){g(a,"id","close-edit-message-button"),g(a,"class","px-3.5 py-1.5 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),g(d,"id","confirm-edit-message-button"),g(d,"class","px-3.5 py-1.5 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),g(i,"class","flex space-x-1.5"),g(n,"class","mt-2 mb-1 flex justify-end text-sm font-medium"),g(e,"class","py-2")},m(M,V){N(M,e,V),O(l,e,null),w(e,r),w(e,n),w(n,i),w(i,a),w(a,u),w(i,f),w(i,d),w(d,b),v=!0,_||(c=[de(a,"click",s[30]),de(d,"click",s[31])],_=!0)},p(M,V){const B={};!t&&V[0]&4096&&(t=!0,B.value=M[12],we(()=>t=!1)),l.$set(B),(!v||V[0]&16384)&&o!==(o=M[14].t("Cancel")+"")&&fe(u,o),(!v||V[0]&16384)&&m!==(m=M[14].t("Save")+"")&&fe(b,m)},i(M){v||(p(l.$$.fragment,M),v=!0)},o(M){$(l.$$.fragment,M),v=!1},d(M){M&&h(e),P(l),_=!1,jt(c)}}}function xl(s){var n,i;let e,l,t;e=new Tt({props:{id:s[0].id,content:s[0].content}});let r=s[0].created_at!==s[0].updated_at&&(((i=(n=s[0])==null?void 0:n.meta)==null?void 0:i.model_id)??null)===null&&et(s);return{c(){j(e.$$.fragment),r&&r.c(),l=re()},l(a){A(e.$$.fragment,a),r&&r.l(a),l=re()},m(a,o){O(e,a,o),r&&r.m(a,o),N(a,l,o),t=!0},p(a,o){var f,d;const u={};o[0]&1&&(u.id=a[0].id),o[0]&1&&(u.content=a[0].content),e.$set(u),a[0].created_at!==a[0].updated_at&&(((d=(f=a[0])==null?void 0:f.meta)==null?void 0:d.model_id)??null)===null?r?r.p(a,o):(r=et(a),r.c(),r.m(l.parentNode,l)):r&&(r.d(1),r=null)},i(a){t||(p(e.$$.fragment,a),t=!0)},o(a){$(e.$$.fragment,a),t=!1},d(a){a&&h(l),P(e,a),r&&r.d(a)}}}function er(s){let e,l;return e=new _l({}),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p:ae,i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function et(s){let e,l,t=s[14].t("edited")+"",r,n;return{c(){e=T("span"),l=ne("("),r=ne(t),n=ne(")"),this.h()},l(i){e=D(i,"SPAN",{class:!0});var a=I(e);l=se(a,"("),r=se(a,t),n=se(a,")"),a.forEach(h),this.h()},h(){g(e,"class","text-gray-500 text-[10px]")},m(i,a){N(i,e,a),w(e,l),w(e,r),w(e,n)},p(i,a){a[0]&16384&&t!==(t=i[14].t("edited")+"")&&fe(r,t)},d(i){i&&h(e)}}}function tt(s){let e,l,t,r,n,i=Ee(s[0].reactions),a=[];for(let u=0;u<i.length;u+=1)a[u]=rt(He(s,i,u));const o=u=>$(a[u],1,1,()=>{a[u]=null});return r=new Dt({props:{onSubmit:s[33],$$slots:{default:[rr]},$$scope:{ctx:s}}}),{c(){e=T("div"),l=T("div");for(let u=0;u<a.length;u+=1)a[u].c();t=Z(),j(r.$$.fragment),this.h()},l(u){e=D(u,"DIV",{});var f=I(e);l=D(f,"DIV",{class:!0});var d=I(l);for(let m=0;m<a.length;m+=1)a[m].l(d);t=G(d),A(r.$$.fragment,d),d.forEach(h),f.forEach(h),this.h()},h(){g(l,"class","flex items-center flex-wrap gap-y-1.5 gap-1 mt-1 mb-2")},m(u,f){N(u,e,f),w(e,l);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(l,null);w(l,t),O(r,l,null),n=!0},p(u,f){if(f[0]&33281){i=Ee(u[0].reactions);let m;for(m=0;m<i.length;m+=1){const b=He(u,i,m);a[m]?(a[m].p(b,f),p(a[m],1)):(a[m]=rt(b),a[m].c(),p(a[m],1),a[m].m(l,t))}for(J(),m=i.length;m<a.length;m+=1)o(m);x()}const d={};f[0]&512&&(d.onSubmit=u[33]),f[0]&16384|f[1]&1024&&(d.$$scope={dirty:f,ctx:u}),r.$set(d)},i(u){if(!n){for(let f=0;f<i.length;f+=1)p(a[f]);p(r.$$.fragment,u),n=!0}},o(u){a=a.filter(Boolean);for(let f=0;f<a.length;f+=1)$(a[f]);$(r.$$.fragment,u),n=!1},d(u){u&&h(e),gt(a,u),P(r)}}}function lt(s){var r;let e,l=((r=s[35].user_ids)==null?void 0:r.length)+"",t;return{c(){e=T("div"),t=ne(l),this.h()},l(n){e=D(n,"DIV",{class:!0});var i=I(e);t=se(i,l),i.forEach(h),this.h()},h(){g(e,"class","text-xs font-medium text-gray-500 dark:text-gray-400")},m(n,i){N(n,e,i),w(e,t)},p(n,i){var a;i[0]&1&&l!==(l=((a=n[35].user_ids)==null?void 0:a.length)+"")&&fe(t,l)},d(n){n&&h(e)}}}function tr(s){let e,l,t,r,n,i,a;l=new ml({props:{shortCode:s[35].name}});let o=s[35].user_ids.length>0&&lt(s);function u(){return s[32](s[35])}return{c(){e=T("button"),j(l.$$.fragment),t=Z(),o&&o.c(),this.h()},l(f){e=D(f,"BUTTON",{class:!0});var d=I(e);A(l.$$.fragment,d),t=G(d),o&&o.l(d),d.forEach(h),this.h()},h(){var f;g(e,"class",r="flex items-center gap-1.5 transition rounded-xl px-2 py-1 cursor-pointer "+(s[35].user_ids.includes((f=s[15])==null?void 0:f.id)?" bg-blue-300/10 outline outline-blue-500/50 outline-1":"bg-gray-300/10 dark:bg-gray-500/10 hover:outline hover:outline-gray-700/30 dark:hover:outline-gray-300/30 hover:outline-1"))},m(f,d){N(f,e,d),O(l,e,null),w(e,t),o&&o.m(e,null),n=!0,i||(a=de(e,"click",u),i=!0)},p(f,d){var b;s=f;const m={};d[0]&1&&(m.shortCode=s[35].name),l.$set(m),s[35].user_ids.length>0?o?o.p(s,d):(o=lt(s),o.c(),o.m(e,null)):o&&(o.d(1),o=null),(!n||d[0]&32769&&r!==(r="flex items-center gap-1.5 transition rounded-xl px-2 py-1 cursor-pointer "+(s[35].user_ids.includes((b=s[15])==null?void 0:b.id)?" bg-blue-300/10 outline outline-blue-500/50 outline-1":"bg-gray-300/10 dark:bg-gray-500/10 hover:outline hover:outline-gray-700/30 dark:hover:outline-gray-300/30 hover:outline-1")))&&g(e,"class",r)},i(f){n||(p(l.$$.fragment,f),n=!0)},o(f){$(l.$$.fragment,f),n=!1},d(f){f&&h(e),P(l),o&&o.d(),i=!1,a()}}}function rt(s){let e,l;return e=new _e({props:{content:`:${s[35].name}:`,$$slots:{default:[tr]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,r){const n={};r[0]&1&&(n.content=`:${t[35].name}:`),r[0]&33281|r[1]&1024&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function lr(s){let e,l,t;return l=new Ct({}),{c(){e=T("div"),j(l.$$.fragment),this.h()},l(r){e=D(r,"DIV",{class:!0});var n=I(e);A(l.$$.fragment,n),n.forEach(h),this.h()},h(){g(e,"class","flex items-center gap-1.5 bg-gray-500/10 hover:outline hover:outline-gray-700/30 dark:hover:outline-gray-300/30 hover:outline-1 transition rounded-xl px-1 py-1 cursor-pointer text-gray-500 dark:text-gray-400")},m(r,n){N(r,e,n),O(l,e,null),t=!0},p:ae,i(r){t||(p(l.$$.fragment,r),t=!0)},o(r){$(l.$$.fragment,r),t=!1},d(r){r&&h(e),P(l)}}}function rr(s){let e,l;return e=new _e({props:{content:s[14].t("Add Reaction"),$$slots:{default:[lr]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,r){const n={};r[0]&16384&&(n.content=t[14].t("Add Reaction")),r[1]&1024&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function nt(s){let e,l,t,r=s[14].t("{{COUNT}} Replies",{COUNT:s[0].reply_count})+"",n,i,a=" - ",o,u=s[14].t("Last reply")+"",f,d,m=ie.unix(s[0].latest_reply_at/1e9).fromNow()+"",b,v,_,c,k,L,M;return c=new dl({props:{className:"size-2.5",strokeWidth:"3"}}),{c(){e=T("div"),l=T("button"),t=T("span"),n=ne(r),i=T("span"),o=ne(a),f=ne(u),d=Z(),b=ne(m),v=Z(),_=T("span"),j(c.$$.fragment),this.h()},l(V){e=D(V,"DIV",{class:!0});var B=I(e);l=D(B,"BUTTON",{class:!0});var X=I(l);t=D(X,"SPAN",{class:!0});var y=I(t);n=se(y,r),y.forEach(h),i=D(X,"SPAN",{});var U=I(i);o=se(U,a),f=se(U,u),d=G(U),b=se(U,m),U.forEach(h),v=G(X),_=D(X,"SPAN",{class:!0});var R=I(_);A(c.$$.fragment,R),R.forEach(h),X.forEach(h),B.forEach(h),this.h()},h(){g(t,"class","font-medium mr-1"),g(_,"class","ml-1"),g(l,"class","flex items-center text-xs py-1 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition"),g(e,"class","flex items-center gap-1.5 -mt-0.5 mb-1.5")},m(V,B){N(V,e,B),w(e,l),w(l,t),w(t,n),w(l,i),w(i,o),w(i,f),w(i,d),w(i,b),w(l,v),w(l,_),O(c,_,null),k=!0,L||(M=de(l,"click",s[34]),L=!0)},p(V,B){(!k||B[0]&16385)&&r!==(r=V[14].t("{{COUNT}} Replies",{COUNT:V[0].reply_count})+"")&&fe(n,r),(!k||B[0]&16384)&&u!==(u=V[14].t("Last reply")+"")&&fe(f,u),(!k||B[0]&1)&&m!==(m=ie.unix(V[0].latest_reply_at/1e9).fromNow()+"")&&fe(b,m)},i(V){k||(p(c.$$.fragment,V),k=!0)},o(V){$(c.$$.fragment,V),k=!1},d(V){V&&h(e),P(c),L=!1,M()}}}function nr(s){let e,l,t,r,n;function i(u){s[19](u)}let a={title:s[14].t("Delete Message"),message:s[14].t("Are you sure you want to delete this message?"),onConfirm:s[18]};s[13]!==void 0&&(a.show=s[13]),e=new il({props:a}),be.push(()=>$e(e,"show",i));let o=s[0]&&Ye(s);return{c(){j(e.$$.fragment),t=Z(),o&&o.c(),r=re()},l(u){A(e.$$.fragment,u),t=G(u),o&&o.l(u),r=re()},m(u,f){O(e,u,f),N(u,t,f),o&&o.m(u,f),N(u,r,f),n=!0},p(u,f){const d={};f[0]&16384&&(d.title=u[14].t("Delete Message")),f[0]&16384&&(d.message=u[14].t("Are you sure you want to delete this message?")),f[0]&32&&(d.onConfirm=u[18]),!l&&f[0]&8192&&(l=!0,d.show=u[13],we(()=>l=!1)),e.$set(d),u[0]?o?(o.p(u,f),f[0]&1&&p(o,1)):(o=Ye(u),o.c(),p(o,1),o.m(r.parentNode,r)):o&&(J(),$(o,1,1,()=>{o=null}),x())},i(u){n||(p(e.$$.fragment,u),p(o),n=!0)},o(u){$(e.$$.fragment,u),$(o),n=!1},d(u){u&&(h(t),h(r)),P(e,u),o&&o.d(u)}}}function sr(s,e,l){let t,r,n;oe(s,Me,S=>l(15,r=S)),oe(s,Wt,S=>l(16,n=S)),ie.extend(Et),ie.extend(yt),ie.extend(It),ie.extend(xt);const i=De("i18n");oe(s,i,S=>l(14,t=S));let{message:a}=e,{showUserProfile:o=!0}=e,{thread:u=!1}=e,{replyToMessage:f=!1}=e,{disabled:d=!1}=e,{onDelete:m=()=>{}}=e,{onEdit:b=()=>{}}=e,{onReply:v=()=>{}}=e,{onThread:_=()=>{}}=e,{onReaction:c=()=>{}}=e,k=!1,L=!1,M=null,V=!1;const B=async()=>{await m()};function X(S){V=S,l(13,V)}const y=()=>{l(10,k=!0)},U=()=>l(10,k=!1),R=S=>{l(10,k=!1),c(S)},H=()=>{v(a)},F=()=>{_(a.id)},E=()=>{l(11,L=!0),l(12,M=a.content)},ee=()=>l(13,V=!0),W=()=>{const S=document.getElementById(`message-${a.reply_to_message.id}`);if(S){S.scrollIntoView({behavior:"smooth",block:"center"}),S.classList.add("highlight"),setTimeout(()=>{S.classList.remove("highlight")},2e3);return}},q=S=>{var te,me;S.key==="Escape"&&((te=document.getElementById("close-edit-message-button"))==null||te.click());const ce=S.metaKey||S.ctrlKey,ue=S.key==="Enter";ce&&ue&&((me=document.getElementById("confirm-edit-message-button"))==null||me.click())};function Q(S){M=S,l(12,M)}const K=()=>{l(11,L=!1),l(12,M=null)},z=async()=>{b(M),l(11,L=!1),l(12,M=null)},Y=S=>{c(S.name)},C=S=>{c(S)},le=()=>{_(a.id)};return s.$$set=S=>{"message"in S&&l(0,a=S.message),"showUserProfile"in S&&l(1,o=S.showUserProfile),"thread"in S&&l(2,u=S.thread),"replyToMessage"in S&&l(3,f=S.replyToMessage),"disabled"in S&&l(4,d=S.disabled),"onDelete"in S&&l(5,m=S.onDelete),"onEdit"in S&&l(6,b=S.onEdit),"onReply"in S&&l(7,v=S.onReply),"onThread"in S&&l(8,_=S.onThread),"onReaction"in S&&l(9,c=S.onReaction)},[a,o,u,f,d,m,b,v,_,c,k,L,M,V,t,r,n,i,B,X,y,U,R,H,F,E,ee,W,q,Q,K,z,Y,C,le]}class ir extends ge{constructor(e){super(),pe(this,e,sr,nr,he,{message:0,showUserProfile:1,thread:2,replyToMessage:3,disabled:4,onDelete:5,onEdit:6,onReply:7,onThread:8,onReaction:9},null,[-1,-1])}}function st(s,e,l){const t=s.slice();return t[21]=e[l],t[23]=l,t}function Ne(s){const e=s.slice(),l=e[0].slice().reverse();return e[20]=l,e}function it(s){let e,l,t,r,n=[],i=new Map,a,o,u;const f=[or,ar],d=[];function m(_,c){return _[4]?_[5]?-1:1:0}~(l=m(s))&&(t=d[l]=f[l](s));let b=Ee(s[20]);const v=_=>_[1]?`${_[1]}-${_[21].id}`:_[21].id;for(let _=0;_<b.length;_+=1){let c=st(s,b,_),k=v(c);i.set(k,n[_]=ot(k,c))}return{c(){e=T("div"),t&&t.c(),r=Z();for(let _=0;_<n.length;_+=1)n[_].c();a=Z(),o=T("div"),this.h()},l(_){e=D(_,"DIV",{});var c=I(e);t&&t.l(c),r=G(c);for(let k=0;k<n.length;k+=1)n[k].l(c);a=G(c),o=D(c,"DIV",{class:!0}),I(o).forEach(h),c.forEach(h),this.h()},h(){g(o,"class","pb-6")},m(_,c){N(_,e,c),~l&&d[l].m(e,null),w(e,r);for(let k=0;k<n.length;k+=1)n[k]&&n[k].m(e,null);w(e,a),w(e,o),u=!0},p(_,c){let k=l;l=m(_),l===k?~l&&d[l].p(_,c):(t&&(J(),$(d[k],1,1,()=>{d[k]=null}),x()),~l?(t=d[l],t?t.p(_,c):(t=d[l]=f[l](_),t.c()),p(t,1),t.m(e,r)):t=null),c&1263&&(b=Ee(_[20]),J(),n=Qt(n,c,v,1,_,b,i,e,Jt,ot,a,st),x())},i(_){if(!u){p(t);for(let c=0;c<b.length;c+=1)p(n[c]);u=!0}},o(_){$(t);for(let c=0;c<n.length;c+=1)$(n[c]);u=!1},d(_){_&&h(e),~l&&d[l].d();for(let c=0;c<n.length;c+=1)n[c].d()}}}function ar(s){let e,l;function t(a,o){return a[2]?ur:fr}let r=t(s),n=r(s),i=s[20].length>0&&at();return{c(){e=T("div"),n.c(),l=Z(),i&&i.c(),this.h()},l(a){e=D(a,"DIV",{class:!0});var o=I(e);n.l(o),l=G(o),i&&i.l(o),o.forEach(h),this.h()},h(){g(e,"class","px-5 max-w-full mx-auto")},m(a,o){N(a,e,o),n.m(e,null),w(e,l),i&&i.m(e,null)},p(a,o){r===(r=t(a))&&n?n.p(a,o):(n.d(1),n=r(a),n&&(n.c(),n.m(e,l))),a[20].length>0?i||(i=at(),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},i:ae,o:ae,d(a){a&&h(e),n.d(),i&&i.d()}}}function or(s){let e,l;return e=new hl({props:{$$slots:{default:[cr]},$$scope:{ctx:s}}}),e.$on("visible",s[14]),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,r){const n={};r&16777728&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function fr(s){let e,l,t=s[9].t("Start of the channel")+"",r;return{c(){e=T("div"),l=T("div"),r=ne(t),this.h()},l(n){e=D(n,"DIV",{class:!0});var i=I(e);l=D(i,"DIV",{class:!0});var a=I(l);r=se(a,t),a.forEach(h),i.forEach(h),this.h()},h(){g(l,"class",""),g(e,"class","flex justify-center text-xs items-center gap-2 py-5")},m(n,i){N(n,e,i),w(e,l),w(l,r)},p(n,i){i&512&&t!==(t=n[9].t("Start of the channel")+"")&&fe(r,t)},d(n){n&&h(e)}}}function ur(s){let e,l,t=s[2].name+"",r,n,i,a=s[9].t("This channel was created on {{createdAt}}. This is the very beginning of the {{channelName}} channel.",{createdAt:ie(s[2].created_at/1e6).format("MMMM D, YYYY"),channelName:s[2].name})+"",o;return{c(){e=T("div"),l=T("div"),r=ne(t),n=Z(),i=T("div"),o=ne(a),this.h()},l(u){e=D(u,"DIV",{class:!0});var f=I(e);l=D(f,"DIV",{class:!0});var d=I(l);r=se(d,t),d.forEach(h),n=G(f),i=D(f,"DIV",{class:!0});var m=I(i);o=se(m,a),m.forEach(h),f.forEach(h),this.h()},h(){g(l,"class","text-2xl font-medium capitalize"),g(i,"class","text-gray-500"),g(e,"class","flex flex-col gap-1.5 pb-5 pt-10")},m(u,f){N(u,e,f),w(e,l),w(l,r),w(e,n),w(e,i),w(i,o)},p(u,f){f&4&&t!==(t=u[2].name+"")&&fe(r,t),f&516&&a!==(a=u[9].t("This channel was created on {{createdAt}}. This is the very beginning of the {{channelName}} channel.",{createdAt:ie(u[2].created_at/1e6).format("MMMM D, YYYY"),channelName:u[2].name})+"")&&fe(o,a)},d(u){u&&h(e)}}}function at(s){let e;return{c(){e=T("hr"),this.h()},l(l){e=D(l,"HR",{class:!0}),this.h()},h(){g(e,"class","border-gray-50 dark:border-gray-700/20 py-2.5 w-full")},m(l,t){N(l,e,t)},d(l){l&&h(e)}}}function cr(s){let e,l,t,r,n=s[9].t("Loading...")+"",i,a;return l=new Mt({props:{className:" size-4"}}),{c(){e=T("div"),j(l.$$.fragment),t=Z(),r=T("div"),i=ne(n),this.h()},l(o){e=D(o,"DIV",{class:!0});var u=I(e);A(l.$$.fragment,u),t=G(u),r=D(u,"DIV",{class:!0});var f=I(r);i=se(f,n),f.forEach(h),u.forEach(h),this.h()},h(){g(r,"class",""),g(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(o,u){N(o,e,u),O(l,e,null),w(e,t),w(e,r),w(r,i),a=!0},p(o,u){(!a||u&512)&&n!==(n=o[9].t("Loading...")+"")&&fe(i,n)},i(o){a||(p(l.$$.fragment,o),a=!0)},o(o){$(l.$$.fragment,o),a=!1},d(o){o&&h(e),P(l)}}}function ot(s,e){var o,u,f,d,m,b,v,_;let l,t,r;function n(){return e[15](e[21])}function i(...c){return e[16](e[21],...c)}function a(...c){return e[19](e[21],...c)}return t=new ir({props:{message:e[21],thread:e[5],replyToMessage:((o=e[3])==null?void 0:o.id)===e[21].id,disabled:!((u=e[2])!=null&&u.write_access),showUserProfile:e[23]===0||((f=e[20].at(e[23]-1))==null?void 0:f.user_id)!==e[21].user_id||((m=(d=e[20].at(e[23]-1))==null?void 0:d.meta)==null?void 0:m.model_id)!==((v=(b=e[21])==null?void 0:b.meta)==null?void 0:v.model_id)||((_=e[21])==null?void 0:_.reply_to_message),onDelete:n,onEdit:i,onReply:e[17],onThread:e[18],onReaction:a}}),{key:s,first:null,c(){l=re(),j(t.$$.fragment),this.h()},l(c){l=re(),A(t.$$.fragment,c),this.h()},h(){this.first=l},m(c,k){N(c,l,k),O(t,c,k),r=!0},p(c,k){var M,V,B,X,y,U,R,H;e=c;const L={};k&1&&(L.message=e[21]),k&32&&(L.thread=e[5]),k&9&&(L.replyToMessage=((M=e[3])==null?void 0:M.id)===e[21].id),k&4&&(L.disabled=!((V=e[2])!=null&&V.write_access)),k&1&&(L.showUserProfile=e[23]===0||((B=e[20].at(e[23]-1))==null?void 0:B.user_id)!==e[21].user_id||((y=(X=e[20].at(e[23]-1))==null?void 0:X.meta)==null?void 0:y.model_id)!==((R=(U=e[21])==null?void 0:U.meta)==null?void 0:R.model_id)||((H=e[21])==null?void 0:H.reply_to_message)),k&1&&(L.onDelete=n),k&1&&(L.onEdit=i),k&64&&(L.onReply=e[17]),k&128&&(L.onThread=e[18]),k&1025&&(L.onReaction=a),t.$set(L)},i(c){r||(p(t.$$.fragment,c),r=!0)},o(c){$(t.$$.fragment,c),r=!1},d(c){c&&h(l),P(t,c)}}}function dr(s){let e,l,t=s[0]&&it(Ne(s));return{c(){t&&t.c(),e=re()},l(r){t&&t.l(r),e=re()},m(r,n){t&&t.m(r,n),N(r,e,n),l=!0},p(r,[n]){r[0]?t?(t.p(Ne(r),n),n&1&&p(t,1)):(t=it(Ne(r)),t.c(),p(t,1),t.m(e.parentNode,e)):t&&(J(),$(t,1,1,()=>{t=null}),x())},i(r){l||(p(t),l=!0)},o(r){$(t),l=!1},d(r){r&&h(e),t&&t.d(r)}}}function mr(s,e,l){let t,r;oe(s,Me,y=>l(10,r=y)),ie.extend(Et),ie.extend(yt),ie.extend(It);const n=De("i18n");oe(s,n,y=>l(9,t=y));let{id:i=null}=e,{channel:a=null}=e,{messages:o=[]}=e,{replyToMessage:u=null}=e,{top:f=!1}=e,{thread:d=!1}=e,{onLoad:m=()=>{}}=e,{onReply:b=()=>{}}=e,{onThread:v=()=>{}}=e,_=!1;const c=async()=>{const y=document.getElementById("messages-container");y.scrollTop=y.scrollTop+100,l(8,_=!0),await m(),await Te(),l(8,_=!1)},k=y=>{console.info("visible"),_||c()},L=y=>{l(0,o=o.filter(U=>U.id!==y.id)),Gt(localStorage.token,y.channel_id,y.id).catch(U=>(ke.error(`${U}`),null))},M=(y,U)=>{l(0,o=o.map(R=>(R.id===y.id&&(R.content=U),R))),Ft(localStorage.token,y.channel_id,y.id,{content:U}).catch(R=>(ke.error(`${R}`),null))},V=y=>{b(y)},B=y=>{v(y)},X=(y,U)=>{var R,H;((H=(R=((y==null?void 0:y.reactions)??[]).find(F=>F.name===U))==null?void 0:R.user_ids)==null?void 0:H.includes(r==null?void 0:r.id))??!1?(l(0,o=o.map(F=>{if(F.id===y.id){const E=F.reactions.find(ee=>ee.name===U);E&&(E.user_ids=E.user_ids.filter(ee=>ee!==(r==null?void 0:r.id)),E.count=E.user_ids.length,E.count===0&&(F.reactions=F.reactions.filter(ee=>ee.name!==U)))}return F})),Kt(localStorage.token,y.channel_id,y.id,U).catch(F=>(ke.error(`${F}`),null))):(l(0,o=o.map(F=>{if(F.id===y.id&&F.reactions){const E=F.reactions.find(ee=>ee.name===U);E?(E.user_ids.push(r==null?void 0:r.id),E.count=E.user_ids.length):F.reactions.push({name:U,user_ids:[r==null?void 0:r.id],count:1})}return F})),qt(localStorage.token,y.channel_id,y.id,U).catch(F=>(ke.error(`${F}`),null)))};return s.$$set=y=>{"id"in y&&l(1,i=y.id),"channel"in y&&l(2,a=y.channel),"messages"in y&&l(0,o=y.messages),"replyToMessage"in y&&l(3,u=y.replyToMessage),"top"in y&&l(4,f=y.top),"thread"in y&&l(5,d=y.thread),"onLoad"in y&&l(13,m=y.onLoad),"onReply"in y&&l(6,b=y.onReply),"onThread"in y&&l(7,v=y.onThread)},[o,i,a,u,f,d,b,v,_,t,r,n,c,m,k,L,M,V,B,X]}class Nt extends ge{constructor(e){super(),pe(this,e,mr,dr,he,{id:1,channel:2,messages:0,replyToMessage:3,top:4,thread:5,onLoad:13,onReply:6,onThread:7})}}function ft(s){let e,l,t,r;return l=new _e({props:{content:s[2]?s[3].t("Close Sidebar"):s[3].t("Open Sidebar"),interactive:!0,$$slots:{default:[_r]},$$scope:{ctx:s}}}),{c(){e=T("div"),j(l.$$.fragment),this.h()},l(n){e=D(n,"DIV",{class:!0});var i=I(e);A(l.$$.fragment,i),i.forEach(h),this.h()},h(){g(e,"class",t=(s[2]?"md:hidden":"")+" mr-1.5 mt-0.5 self-start flex flex-none items-center text-gray-600 dark:text-gray-400")},m(n,i){N(n,e,i),O(l,e,null),r=!0},p(n,i){const a={};i&12&&(a.content=n[2]?n[3].t("Close Sidebar"):n[3].t("Open Sidebar")),i&260&&(a.$$scope={dirty:i,ctx:n}),l.$set(a),(!r||i&4&&t!==(t=(n[2]?"md:hidden":"")+" mr-1.5 mt-0.5 self-start flex flex-none items-center text-gray-600 dark:text-gray-400"))&&g(e,"class",t)},i(n){r||(p(l.$$.fragment,n),r=!0)},o(n){$(l.$$.fragment,n),r=!1},d(n){n&&h(e),P(l)}}}function _r(s){let e,l,t,r,n,i;return t=new pl({}),{c(){e=T("button"),l=T("div"),j(t.$$.fragment),this.h()},l(a){e=D(a,"BUTTON",{id:!0,class:!0});var o=I(e);l=D(o,"DIV",{class:!0});var u=I(l);A(t.$$.fragment,u),u.forEach(h),o.forEach(h),this.h()},h(){g(l,"class","self-center p-1.5"),g(e,"id","sidebar-toggle-button"),g(e,"class","cursor-pointer flex rounded-lg hover:bg-gray-100 dark:hover:bg-gray-850 transition cursor-")},m(a,o){N(a,e,o),w(e,l),O(t,l,null),r=!0,n||(i=de(e,"click",s[6]),n=!0)},p:ae,i(a){r||(p(t.$$.fragment,a),r=!0)},o(a){$(t.$$.fragment,a),r=!1},d(a){a&&h(e),P(t),n=!1,i()}}}function ut(s){let e,l=s[0].name+"",t;return{c(){e=T("div"),t=ne(l),this.h()},l(r){e=D(r,"DIV",{class:!0});var n=I(e);t=se(n,l),n.forEach(h),this.h()},h(){g(e,"class","line-clamp-1 capitalize font-medium font-primary text-lg")},m(r,n){N(r,e,n),w(e,t)},p(r,n){n&1&&l!==(l=r[0].name+"")&&fe(t,l)},d(r){r&&h(e)}}}function ct(s){var t;let e,l;return e=new gl({props:{className:"max-w-[240px]",role:(t=s[4])==null?void 0:t.role,help:!0,$$slots:{default:[hr]},$$scope:{ctx:s}}}),e.$on("show",s[7]),{c(){j(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,n){O(e,r,n),l=!0},p(r,n){var a;const i={};n&16&&(i.role=(a=r[4])==null?void 0:a.role),n&272&&(i.$$scope={dirty:n,ctx:r}),e.$set(i)},i(r){l||(p(e.$$.fragment,r),l=!0)},o(r){$(e.$$.fragment,r),l=!1},d(r){P(e,r)}}}function hr(s){let e,l,t,r;return{c(){e=T("button"),l=T("div"),t=T("img"),this.h()},l(n){e=D(n,"BUTTON",{class:!0,"aria-label":!0});var i=I(e);l=D(i,"DIV",{class:!0});var a=I(l);t=D(a,"IMG",{src:!0,class:!0,alt:!0,draggable:!0}),a.forEach(h),i.forEach(h),this.h()},h(){var n;ve(t.src,r=(n=s[4])==null?void 0:n.profile_image_url)||g(t,"src",r),g(t,"class","size-6 object-cover rounded-full"),g(t,"alt","User profile"),g(t,"draggable","false"),g(l,"class","self-center"),g(e,"class","select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition"),g(e,"aria-label","User Menu")},m(n,i){N(n,e,i),w(e,l),w(l,t)},p(n,i){var a;i&16&&!ve(t.src,r=(a=n[4])==null?void 0:a.profile_image_url)&&g(t,"src",r)},d(n){n&&h(e)}}}function gr(s){let e,l,t,r,n,i,a,o,u,f,d,m=s[1]&&ft(s),b=s[0]&&ut(s),v=s[4]!==void 0&&ct(s);return{c(){e=T("nav"),l=T("div"),t=Z(),r=T("div"),n=T("div"),m&&m.c(),i=Z(),a=T("div"),b&&b.c(),u=Z(),f=T("div"),v&&v.c(),this.h()},l(_){e=D(_,"NAV",{class:!0});var c=I(e);l=D(c,"DIV",{class:!0}),I(l).forEach(h),t=G(c),r=D(c,"DIV",{class:!0});var k=I(r);n=D(k,"DIV",{class:!0});var L=I(n);m&&m.l(L),i=G(L),a=D(L,"DIV",{class:!0});var M=I(a);b&&b.l(M),M.forEach(h),u=G(L),f=D(L,"DIV",{class:!0});var V=I(f);v&&v.l(V),V.forEach(h),L.forEach(h),k.forEach(h),c.forEach(h),this.h()},h(){g(l,"class","bg-linear-to-b via-50% from-white via-white to-transparent dark:from-gray-900 dark:via-gray-900 dark:to-transparent pointer-events-none absolute inset-0 -bottom-7 z-[-1]"),g(a,"class",o="flex-1 overflow-hidden max-w-full py-0.5 "+(s[2]?"ml-1":"")),g(f,"class","self-start flex flex-none items-center text-gray-600 dark:text-gray-400"),g(n,"class","flex items-center w-full max-w-full"),g(r,"class","flex max-w-full w-full mx-auto px-1 pt-0.5 bg-transparent"),g(e,"class","sticky top-0 z-30 w-full px-1.5 py-1.5 -mb-8 flex items-center drag-region")},m(_,c){N(_,e,c),w(e,l),w(e,t),w(e,r),w(r,n),m&&m.m(n,null),w(n,i),w(n,a),b&&b.m(a,null),w(n,u),w(n,f),v&&v.m(f,null),d=!0},p(_,[c]){_[1]?m?(m.p(_,c),c&2&&p(m,1)):(m=ft(_),m.c(),p(m,1),m.m(n,i)):m&&(J(),$(m,1,1,()=>{m=null}),x()),_[0]?b?b.p(_,c):(b=ut(_),b.c(),b.m(a,null)):b&&(b.d(1),b=null),(!d||c&4&&o!==(o="flex-1 overflow-hidden max-w-full py-0.5 "+(_[2]?"ml-1":"")))&&g(a,"class",o),_[4]!==void 0?v?(v.p(_,c),c&16&&p(v,1)):(v=ct(_),v.c(),p(v,1),v.m(f,null)):v&&(J(),$(v,1,1,()=>{v=null}),x())},i(_){d||(p(m),p(v),d=!0)},o(_){$(m),$(v),d=!1},d(_){_&&h(e),m&&m.d(),b&&b.d(),v&&v.d()}}}function pr(s,e,l){let t,r,n,i;oe(s,Yt,d=>l(1,t=d)),oe(s,Le,d=>l(2,r=d)),oe(s,Me,d=>l(4,i=d));const a=De("i18n");oe(s,a,d=>l(3,n=d));let{channel:o}=e;const u=()=>{Le.set(!r)},f=d=>{d.detail==="archived-chat"&&Zt.set(!0)};return s.$$set=d=>{"channel"in d&&l(0,o=d.channel)},[o,t,r,n,i,a,u,f]}class br extends ge{constructor(e){super(),pe(this,e,pr,gr,he,{channel:0})}}function dt(s){var E,ee;let e,l,t,r=s[9].t("Thread")+"",n,i,a,o,u,f,d,m,b,v,_,c,k,L,M,V,B;u=new vl({});const X=[kr,vr],y=[];function U(W,q){return W[3]!==null?0:1}m=U(s),b=y[m]=X[m](s);function R(W){s[16](W)}function H(W){s[17](W)}let F={id:s[0],disabled:!((E=s[1])!=null&&E.write_access),placeholder:(ee=s[1])!=null&&ee.write_access?s[9].t("Reply to thread..."):s[9].t("You do not have permission to send messages in this thread."),typingUsersClassName:"from-gray-50 dark:from-gray-850",typingUsers:s[8],userSuggestions:!0,channelSuggestions:!0,onChange:s[12],onSubmit:s[11]};return s[7]!==void 0&&(F.replyToMessage=s[7]),s[6]!==void 0&&(F.chatInputElement=s[6]),c=new Vt({props:F}),be.push(()=>$e(c,"replyToMessage",R)),be.push(()=>$e(c,"chatInputElement",H)),{c(){e=T("div"),l=T("div"),t=T("div"),n=ne(r),i=Z(),a=T("div"),o=T("button"),j(u.$$.fragment),f=Z(),d=T("div"),b.c(),v=Z(),_=T("div"),j(c.$$.fragment),this.h()},l(W){e=D(W,"DIV",{class:!0});var q=I(e);l=D(q,"DIV",{class:!0});var Q=I(l);t=D(Q,"DIV",{class:!0});var K=I(t);n=se(K,r),K.forEach(h),i=G(Q),a=D(Q,"DIV",{});var z=I(a);o=D(z,"BUTTON",{class:!0});var Y=I(o);A(u.$$.fragment,Y),Y.forEach(h),z.forEach(h),Q.forEach(h),f=G(q),d=D(q,"DIV",{class:!0});var C=I(d);b.l(C),v=G(C),_=D(C,"DIV",{class:!0});var le=I(_);A(c.$$.fragment,le),le.forEach(h),C.forEach(h),q.forEach(h),this.h()},h(){g(t,"class","font-medium text-lg"),g(o,"class","text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 p-2"),g(l,"class","sticky top-0 flex items-center justify-between px-3.5 py-3"),g(_,"class","pb-[1rem] px-2.5 w-full"),g(d,"class","max-h-full w-full overflow-y-auto"),g(e,"class","flex flex-col w-full h-full bg-gray-50 dark:bg-gray-850")},m(W,q){N(W,e,q),w(e,l),w(l,t),w(t,n),w(l,i),w(l,a),w(a,o),O(u,o,null),w(e,f),w(e,d),y[m].m(d,null),w(d,v),w(d,_),O(c,_,null),s[18](d),M=!0,V||(B=de(o,"click",s[13]),V=!0)},p(W,q){var z,Y;(!M||q&512)&&r!==(r=W[9].t("Thread")+"")&&fe(n,r);let Q=m;m=U(W),m===Q?y[m].p(W,q):(J(),$(y[Q],1,1,()=>{y[Q]=null}),x(),b=y[m],b?b.p(W,q):(b=y[m]=X[m](W),b.c()),p(b,1),b.m(d,v));const K={};q&1&&(K.id=W[0]),q&2&&(K.disabled=!((z=W[1])!=null&&z.write_access)),q&514&&(K.placeholder=(Y=W[1])!=null&&Y.write_access?W[9].t("Reply to thread..."):W[9].t("You do not have permission to send messages in this thread.")),q&256&&(K.typingUsers=W[8]),!k&&q&128&&(k=!0,K.replyToMessage=W[7],we(()=>k=!1)),!L&&q&64&&(L=!0,K.chatInputElement=W[6],we(()=>L=!1)),c.$set(K)},i(W){M||(p(u.$$.fragment,W),p(b),p(c.$$.fragment,W),M=!0)},o(W){$(u.$$.fragment,W),$(b),$(c.$$.fragment,W),M=!1},d(W){W&&h(e),P(u),y[m].d(),P(c),s[18](null),V=!1,B()}}}function vr(s){let e,l,t;return l=new Mt({}),{c(){e=T("div"),j(l.$$.fragment),this.h()},l(r){e=D(r,"DIV",{class:!0});var n=I(e);A(l.$$.fragment,n),n.forEach(h),this.h()},h(){g(e,"class","w-full flex justify-center pt-5 pb-10")},m(r,n){N(r,e,n),O(l,e,null),t=!0},p:ae,i(r){t||(p(l.$$.fragment,r),t=!0)},o(r){$(l.$$.fragment,r),t=!1},d(r){r&&h(e),P(l)}}}function kr(s){let e,l;return e=new Nt({props:{id:s[0],channel:s[1],top:s[4],messages:s[3],replyToMessage:s[7],thread:!0,onReply:s[14],onLoad:s[15]}}),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,r){const n={};r&1&&(n.id=t[0]),r&2&&(n.channel=t[1]),r&16&&(n.top=t[4]),r&8&&(n.messages=t[3]),r&128&&(n.replyToMessage=t[7]),r&192&&(n.onReply=t[14]),r&27&&(n.onLoad=t[15]),e.$set(n)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function $r(s){let e,l,t=s[1]&&dt(s);return{c(){t&&t.c(),e=re()},l(r){t&&t.l(r),e=re()},m(r,n){t&&t.m(r,n),N(r,e,n),l=!0},p(r,[n]){r[1]?t?(t.p(r,n),n&2&&p(t,1)):(t=dt(r),t.c(),p(t,1),t.m(e.parentNode,e)):t&&(J(),$(t,1,1,()=>{t=null}),x())},i(r){l||(p(t),l=!0)},o(r){$(t),l=!1},d(r){r&&h(e),t&&t.d(r)}}}function wr(s,e,l){let t,r,n;oe(s,$t,E=>l(20,t=E)),oe(s,Me,E=>l(21,r=E));const i=De("i18n");oe(s,i,E=>l(9,n=E));let{threadId:a=null}=e,{channel:o=null}=e,{onClose:u=()=>{}}=e,f=null,d=!1,m=null,b=null,v=null,_=[],c={};const k=()=>{l(5,m.scrollTop=m.scrollHeight,m)},L=async()=>{l(3,f=null),l(4,d=!1),l(8,_=[]),c={},o?(l(3,f=await Ae(localStorage.token,o.id,a)),f.length<50&&l(4,d=!0),await Te(),k()):kt("/")},M=async E=>{var ee,W;if(E.channel_id===o.id){const q=((ee=E==null?void 0:E.data)==null?void 0:ee.type)??null,Q=((W=E==null?void 0:E.data)==null?void 0:W.data)??null;if(q==="message")((Q==null?void 0:Q.parent_id)??null)===a&&f&&(l(3,f=[Q,...f]),_.find(K=>K.id===E.user.id)&&l(8,_=_.filter(K=>K.id!==E.user.id)));else if(q==="message:update"){if(f){const K=f.findIndex(z=>z.id===Q.id);K!==-1&&l(3,f[K]=Q,f)}}else if(q==="message:delete")f&&l(3,f=f.filter(K=>K.id!==Q.id));else if(q.includes("message:reaction")){if(f){const K=f.findIndex(z=>z.id===Q.id);K!==-1&&l(3,f[K]=Q,f)}}else if(q==="typing"&&E.message_id===a){if(E.user.id===(r==null?void 0:r.id))return;l(8,_=Q.typing?[..._,..._.find(K=>K.id===E.user.id)?[]:[{id:E.user.id,name:E.user.name}]]:_.filter(K=>K.id!==E.user.id)),c[E.user.id]&&clearTimeout(c[E.user.id]),c[E.user.id]=setTimeout(()=>{l(8,_=_.filter(K=>K.id!==E.user.id))},5e3)}}},V=async({content:E,data:ee})=>{!E&&((ee==null?void 0:ee.files)??[]).length===0||(await wt(localStorage.token,o.id,{parent_id:a,reply_to_id:(v==null?void 0:v.id)??null,content:E,data:ee}).catch(W=>(ke.error(`${W}`),null)),l(7,v=null))},B=async()=>{t==null||t.emit("events:channel",{channel_id:o.id,message_id:a,data:{type:"typing",data:{typing:!0}}})};pt(()=>{t==null||t.on("events:channel",M)}),bt(()=>{t==null||t.off("events:channel",M)});const X=()=>{u()},y=async E=>{l(7,v=E),await Te(),b==null||b.focus()},U=async()=>{const E=await Ae(localStorage.token,o.id,a,f.length);if(l(3,f=[...f,...E]),E.length<50){l(4,d=!0);return}};function R(E){v=E,l(7,v)}function H(E){b=E,l(6,b)}function F(E){be[E?"unshift":"push"](()=>{m=E,l(5,m)})}return s.$$set=E=>{"threadId"in E&&l(0,a=E.threadId),"channel"in E&&l(1,o=E.channel),"onClose"in E&&l(2,u=E.onClose)},s.$$.update=()=>{s.$$.dirty&1&&a&&L()},[a,o,u,f,d,m,b,v,_,n,i,V,B,X,y,U,R,H,F]}class Lt extends ge{constructor(e){super(),pe(this,e,wr,$r,he,{threadId:0,channel:1,onClose:2})}}function mt(s){let e,l=s[0],t,r,n,i=_t(s);return{c(){e=T("div"),i.c(),this.h()},l(a){e=D(a,"DIV",{class:!0,id:!0});var o=I(e);i.l(o),o.forEach(h),this.h()},h(){g(e,"class","pb-2.5 max-w-full z-10 scrollbar-hidden w-full h-full pt-6 flex-1 flex flex-col-reverse overflow-auto"),g(e,"id","messages-container")},m(a,o){N(a,e,o),i.m(e,null),s[19](e),t=!0,r||(n=de(e,"scroll",s[20]),r=!0)},p(a,o){o[0]&1&&he(l,l=a[0])?(J(),$(i,1,1,ae),x(),i=_t(a),i.c(),p(i,1),i.m(e,null)):i.p(a,o)},i(a){t||(p(i),t=!0)},o(a){$(i),t=!1},d(a){a&&h(e),i.d(a),s[19](null),r=!1,n()}}}function _t(s){let e,l;return e=new Nt({props:{channel:s[5],top:s[4],messages:s[6],replyToMessage:s[7],onReply:s[16],onThread:s[17],onLoad:s[18]}}),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,r){const n={};r[0]&32&&(n.channel=t[5]),r[0]&16&&(n.top=t[4]),r[0]&64&&(n.messages=t[6]),r[0]&128&&(n.replyToMessage=t[7]),r[0]&136&&(n.onReply=t[16]),r[0]&256&&(n.onThread=t[17]),r[0]&81&&(n.onLoad=t[18]),e.$set(n)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Er(s){var v,_;let e,l,t,r,n,i,a,o,u;e=new br({props:{channel:s[5]}});let f=s[5]&&mt(s);function d(c){s[21](c)}function m(c){s[22](c)}let b={id:"root",typingUsers:s[9],userSuggestions:!0,channelSuggestions:!0,disabled:!((v=s[5])!=null&&v.write_access),placeholder:(_=s[5])!=null&&_.write_access?s[12].t("Type here..."):s[12].t("You do not have permission to send messages in this channel."),onChange:s[15],onSubmit:s[14],scrollToBottom:s[13],scrollEnd:s[1]};return s[3]!==void 0&&(b.chatInputElement=s[3]),s[7]!==void 0&&(b.replyToMessage=s[7]),i=new Vt({props:b}),be.push(()=>$e(i,"chatInputElement",d)),be.push(()=>$e(i,"replyToMessage",m)),{c(){j(e.$$.fragment),l=Z(),t=T("div"),f&&f.c(),r=Z(),n=T("div"),j(i.$$.fragment),this.h()},l(c){A(e.$$.fragment,c),l=G(c),t=D(c,"DIV",{class:!0});var k=I(t);f&&f.l(k),k.forEach(h),r=G(c),n=D(c,"DIV",{class:!0});var L=I(n);A(i.$$.fragment,L),L.forEach(h),this.h()},h(){g(t,"class","flex-1 overflow-y-auto"),g(n,"class","pb-[1rem] px-2.5")},m(c,k){O(e,c,k),N(c,l,k),N(c,t,k),f&&f.m(t,null),N(c,r,k),N(c,n,k),O(i,n,null),u=!0},p(c,k){var V,B;const L={};k[0]&32&&(L.channel=c[5]),e.$set(L),c[5]?f?(f.p(c,k),k[0]&32&&p(f,1)):(f=mt(c),f.c(),p(f,1),f.m(t,null)):f&&(J(),$(f,1,1,()=>{f=null}),x());const M={};k[0]&512&&(M.typingUsers=c[9]),k[0]&32&&(M.disabled=!((V=c[5])!=null&&V.write_access)),k[0]&4128&&(M.placeholder=(B=c[5])!=null&&B.write_access?c[12].t("Type here..."):c[12].t("You do not have permission to send messages in this channel.")),k[0]&2&&(M.scrollEnd=c[1]),!a&&k[0]&8&&(a=!0,M.chatInputElement=c[3],we(()=>a=!1)),!o&&k[0]&128&&(o=!0,M.replyToMessage=c[7],we(()=>o=!1)),i.$set(M)},i(c){u||(p(e.$$.fragment,c),p(f),p(i.$$.fragment,c),u=!0)},o(c){$(e.$$.fragment,c),$(f),$(i.$$.fragment,c),u=!1},d(c){c&&(h(l),h(t),h(r),h(n)),P(e,c),f&&f.d(),P(i)}}}function yr(s){let e,l,t,r;return e=new Ht({props:{class:"relative flex items-center justify-center group border-l border-gray-50 dark:border-gray-850 hover:border-gray-200 dark:hover:border-gray-800  transition z-20",id:"controls-resizer",$$slots:{default:[Tr]},$$scope:{ctx:s}}}),t=new vt({props:{defaultSize:50,minSize:30,class:"h-full w-full",$$slots:{default:[Dr]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment),l=Z(),j(t.$$.fragment)},l(n){A(e.$$.fragment,n),l=G(n),A(t.$$.fragment,n)},m(n,i){O(e,n,i),N(n,l,i),O(t,n,i),r=!0},p(n,i){const a={};i[1]&4&&(a.$$scope={dirty:i,ctx:n}),e.$set(a);const o={};i[0]&288|i[1]&4&&(o.$$scope={dirty:i,ctx:n}),t.$set(o)},i(n){r||(p(e.$$.fragment,n),p(t.$$.fragment,n),r=!0)},o(n){$(e.$$.fragment,n),$(t.$$.fragment,n),r=!1},d(n){n&&h(l),P(e,n),P(t,n)}}}function Ir(s){let e,l,t=s[8]!==null&&ht(s);return{c(){t&&t.c(),e=re()},l(r){t&&t.l(r),e=re()},m(r,n){t&&t.m(r,n),N(r,e,n),l=!0},p(r,n){r[8]!==null?t?(t.p(r,n),n[0]&256&&p(t,1)):(t=ht(r),t.c(),p(t,1),t.m(e.parentNode,e)):t&&(J(),$(t,1,1,()=>{t=null}),x())},i(r){l||(p(t),l=!0)},o(r){$(t),l=!1},d(r){r&&h(e),t&&t.d(r)}}}function Tr(s){let e;return{c(){e=T("div"),this.h()},l(l){e=D(l,"DIV",{class:!0}),I(e).forEach(h),this.h()},h(){g(e,"class","absolute -left-1.5 -right-1.5 -top-0 -bottom-0 z-20 cursor-col-resize bg-transparent")},m(l,t){N(l,e,t)},p:ae,d(l){l&&h(e)}}}function Dr(s){let e,l,t;return l=new Lt({props:{threadId:s[8],channel:s[5],onClose:s[25]}}),{c(){e=T("div"),j(l.$$.fragment),this.h()},l(r){e=D(r,"DIV",{class:!0});var n=I(e);A(l.$$.fragment,n),n.forEach(h),this.h()},h(){g(e,"class","h-full w-full shadow-xl")},m(r,n){N(r,e,n),O(l,e,null),t=!0},p(r,n){const i={};n[0]&256&&(i.threadId=r[8]),n[0]&32&&(i.channel=r[5]),n[0]&256&&(i.onClose=r[25]),l.$set(i)},i(r){t||(p(l.$$.fragment,r),t=!0)},o(r){$(l.$$.fragment,r),t=!1},d(r){r&&h(e),P(l)}}}function ht(s){let e,l;return e=new bl({props:{show:s[8]!==null,onClose:s[24],$$slots:{default:[Mr]},$$scope:{ctx:s}}}),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,r){const n={};r[0]&256&&(n.show=t[8]!==null),r[0]&256&&(n.onClose=t[24]),r[0]&288|r[1]&4&&(n.$$scope={dirty:r,ctx:t}),e.$set(n)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Mr(s){let e,l,t,r;return l=new Lt({props:{threadId:s[8],channel:s[5],onClose:s[23]}}),{c(){e=T("div"),j(l.$$.fragment),this.h()},l(n){e=D(n,"DIV",{class:!0});var i=I(e);A(l.$$.fragment,i),i.forEach(h),this.h()},h(){g(e,"class",t=(s[8]!==null?" h-screen  w-full":"px-6 py-4")+" h-full")},m(n,i){N(n,e,i),O(l,e,null),r=!0},p(n,i){const a={};i[0]&256&&(a.threadId=n[8]),i[0]&32&&(a.channel=n[5]),i[0]&256&&(a.onClose=n[23]),l.$set(a),(!r||i[0]&256&&t!==(t=(n[8]!==null?" h-screen  w-full":"px-6 py-4")+" h-full"))&&g(e,"class",t)},i(n){r||(p(l.$$.fragment,n),r=!0)},o(n){$(l.$$.fragment,n),r=!1},d(n){n&&h(e),P(l)}}}function Vr(s){let e,l,t,r,n,i;e=new vt({props:{defaultSize:50,minSize:50,class:"h-full flex flex-col w-full relative",$$slots:{default:[Er]},$$scope:{ctx:s}}});const a=[Ir,yr],o=[];function u(f,d){return f[10]?f[8]!==null?1:-1:0}return~(t=u(s))&&(r=o[t]=a[t](s)),{c(){j(e.$$.fragment),l=Z(),r&&r.c(),n=re()},l(f){A(e.$$.fragment,f),l=G(f),r&&r.l(f),n=re()},m(f,d){O(e,f,d),N(f,l,d),~t&&o[t].m(f,d),N(f,n,d),i=!0},p(f,d){const m={};d[0]&5119|d[1]&4&&(m.$$scope={dirty:d,ctx:f}),e.$set(m);let b=t;t=u(f),t===b?~t&&o[t].p(f,d):(r&&(J(),$(o[b],1,1,()=>{o[b]=null}),x()),~t?(r=o[t],r?r.p(f,d):(r=o[t]=a[t](f),r.c()),p(r,1),r.m(n.parentNode,n)):r=null)},i(f){i||(p(e.$$.fragment,f),p(r),i=!0)},o(f){$(e.$$.fragment,f),$(r),i=!1},d(f){f&&(h(l),h(n)),P(e,f),~t&&o[t].d(f)}}}function Cr(s){var a;let e,l,t,r,n,i;return document.title=e="#"+(((a=s[5])==null?void 0:a.name)??"Channel")+"  Open WebUI",r=new Pt({props:{direction:"horizontal",class:"w-full h-full",$$slots:{default:[Vr]},$$scope:{ctx:s}}}),{c(){l=Z(),t=T("div"),j(r.$$.fragment),this.h()},l(o){At("svelte-dfmiil",document.head).forEach(h),l=G(o),t=D(o,"DIV",{class:!0,id:!0});var f=I(t);A(r.$$.fragment,f),f.forEach(h),this.h()},h(){g(t,"class",n="h-screen max-h-[100dvh] transition-width duration-200 ease-in-out "+(s[11]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col"),g(t,"id","channel-container")},m(o,u){N(o,l,u),N(o,t,u),O(r,t,null),i=!0},p(o,u){var d;(!i||u[0]&32)&&e!==(e="#"+(((d=o[5])==null?void 0:d.name)??"Channel")+"  Open WebUI")&&(document.title=e);const f={};u[0]&6143|u[1]&4&&(f.$$scope={dirty:u,ctx:o}),r.$set(f),(!i||u[0]&2048&&n!==(n="h-screen max-h-[100dvh] transition-width duration-200 ease-in-out "+(o[11]?"md:max-w-[calc(100%-260px)]":"")+" w-full max-w-full flex flex-col"))&&g(t,"class",n)},i(o){i||(p(r.$$.fragment,o),i=!0)},o(o){$(r.$$.fragment,o),i=!1},d(o){o&&(h(l),h(t)),P(r)}}}function Nr(s,e,l){let t,r,n,i,a;oe(s,$t,C=>l(28,t=C)),oe(s,je,C=>l(29,r=C)),oe(s,Me,C=>l(30,n=C)),oe(s,Le,C=>l(11,i=C)),oe(s,kl,C=>l(12,a=C));let{id:o=""}=e,u=!0,f=null,d=null,m=!1,b=null,v=null,_=null,c=null,k=[],L={};const M=()=>{f&&l(2,f.scrollTop=f.scrollHeight,f)},V=async()=>{l(4,m=!1),l(6,v=null),l(5,b=null),l(8,c=null),l(9,k=[]),L={},l(5,b=await Xt(localStorage.token,o).catch(C=>null)),b?(l(6,v=await Oe(localStorage.token,o,0)),v&&(M(),v.length<50&&l(4,m=!0))):kt("/")},B=async C=>{var le,S;if(C.channel_id===o){const ce=((le=C==null?void 0:C.data)==null?void 0:le.type)??null,ue=((S=C==null?void 0:C.data)==null?void 0:S.data)??null;if(ce==="message")((ue==null?void 0:ue.parent_id)??null)===null&&(l(6,v=[ue,...v]),k.find(te=>te.id===C.user.id)&&l(9,k=k.filter(te=>te.id!==C.user.id)),await Te(),u&&M());else if(ce==="message:update"){const te=v.findIndex(me=>me.id===ue.id);te!==-1&&l(6,v[te]=ue,v)}else if(ce==="message:delete")l(6,v=v.filter(te=>te.id!==ue.id));else if(ce==="message:reply"){const te=v.findIndex(me=>me.id===ue.id);te!==-1&&l(6,v[te]=ue,v)}else if(ce.includes("message:reaction")){const te=v.findIndex(me=>me.id===ue.id);te!==-1&&l(6,v[te]=ue,v)}else if(ce==="typing"&&C.message_id===null){if(C.user.id===(n==null?void 0:n.id))return;l(9,k=ue.typing?[...k,...k.find(te=>te.id===C.user.id)?[]:[{id:C.user.id,name:C.user.name}]]:k.filter(te=>te.id!==C.user.id)),L[C.user.id]&&clearTimeout(L[C.user.id]),L[C.user.id]=setTimeout(()=>{l(9,k=k.filter(te=>te.id!==C.user.id))},5e3)}}},X=async({content:C,data:le})=>{if(!C&&((le==null?void 0:le.files)??[]).length===0)return;await wt(localStorage.token,o,{content:C,data:le,reply_to_id:(_==null?void 0:_.id)??null}).catch(ce=>(ke.error(`${ce}`),null))&&l(2,f.scrollTop=f.scrollHeight,f),l(7,_=null)},y=async()=>{t==null||t.emit("events:channel",{channel_id:o,message_id:null,data:{type:"typing",data:{typing:!0}}})};let U,R=!1;pt(()=>{r&&je.set(""),t==null||t.on("events:channel",B),U=window.matchMedia("(min-width: 1024px)");const C=async le=>{le.matches?l(10,R=!0):l(10,R=!1)};U.addEventListener("change",C),C(U)}),bt(()=>{t==null||t.off("events:channel",B)});const H=async C=>{l(7,_=C),await Te(),d==null||d.focus()},F=C=>{l(8,c=C)},E=async()=>{const C=await Oe(localStorage.token,o,v.length);if(l(6,v=[...v,...C]),C.length<50){l(4,m=!0);return}};function ee(C){be[C?"unshift":"push"](()=>{f=C,l(2,f)})}const W=C=>{l(1,u=Math.abs(f.scrollTop)<=50)};function q(C){d=C,l(3,d)}function Q(C){_=C,l(7,_)}const K=()=>{l(8,c=null)},z=()=>{l(8,c=null)},Y=()=>{l(8,c=null)};return s.$$set=C=>{"id"in C&&l(0,o=C.id)},s.$$.update=()=>{s.$$.dirty[0]&1&&o&&V()},[o,u,f,d,m,b,v,_,c,k,R,i,a,M,X,y,H,F,E,ee,W,q,Q,K,z,Y]}class Lr extends ge{constructor(e){super(),pe(this,e,Nr,Cr,he,{id:0},null,[-1,-1])}}function Sr(s){let e,l;return e=new Lr({props:{id:s[0].params.id}}),{c(){j(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,[r]){const n={};r&1&&(n.id=t[0].params.id),e.$set(n)},i(t){l||(p(e.$$.fragment,t),l=!0)},o(t){$(e.$$.fragment,t),l=!1},d(t){P(e,t)}}}function Ur(s,e,l){let t;return oe(s,Ot,r=>l(0,t=r)),[t]}class _n extends ge{constructor(e){super(),pe(this,e,Ur,Sr,he,{})}}export{_n as component};
//# sourceMappingURL=22.BwxR_aZM.js.map
